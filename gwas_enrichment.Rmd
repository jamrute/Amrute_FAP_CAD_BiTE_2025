```{r}
library(Seurat)
library(ggplot2)
library(patchwork)
library(ggpubr)
library(dplyr)
library(sctransform)
library(pheatmap)
library(Matrix)
library(RColorBrewer)
library(scales)
library(data.table)
library(stats)
library("Nebulosa")
library(Seurat)
library(ggplot2)
library(patchwork)
library(ggpubr)
library(dplyr)
library(Seurat)
library(patchwork)
library(sctransform)
library(ggplot2)
library(pheatmap)
library(Seurat)
library(ggplot2)
library(Matrix)
library(RColorBrewer)
library(dplyr)
library(scales)
library(data.table)
library(stats)
library("Nebulosa")
library(tidyverse)
library(hrbrthemes)
library(viridis)
library(magrittr)
library(dplyr)
library(ArchR)
library(pals)
```

# Load the DGE and look for overlap between GWAS genes and DGE List
```{r}
DGE <- read_delim("./DE_SCT_cell.type.csv", ",", escape_double = FALSE, trim_ws = TRUE)
DGE
```

```{r}
DGE <- filter(DGE, DGE$p_val_adj < 0.05)
diff_exp_genes <- unique(DGE$gene)
length(diff_exp_genes)
```

```{r}
GWAS <- read_delim("./cad_gwas_genes.txt", ",", escape_double = FALSE, trim_ws = TRUE)
gwas_genes <- list(GWAS$gene)[[1]]
gwas_genes
```

```{r}
intersecting_genes <- Reduce(intersect, list(diff_exp_genes, gwas_genes))
length(intersecting_genes)
```

```{r}
DGE_subset <- filter(DGE, DGE$gene %in% intersecting_genes)
DGE_subset
```

```{r}
cad_gwas_overlap <- data.frame(sort(table(DGE_subset$cluster), decreasing=T))
cad_gwas_overlap
```

```{r}
pdf("./cad_gwas_overlap.pdf", useDingbats = FALSE, width=3.5, height=2.5)
cad_gwas_overlap$Var1 <- factor(cad_gwas_overlap$Var1, levels = c("BCells", "TCells", "pDC","Mast", "Proliferating","Fibroblast1","Myeloid","Glia","Lymphatic","Fibroblast2","SMCPericyte","Endothelium","ModSMC"))
ggplot(cad_gwas_overlap, aes(x=Var1, y=Freq)) +
    geom_segment( aes(xend=Var1, yend=0.5)) +
    geom_point( size=2, color="black") +
    coord_flip() +
    theme_bw() +
    xlab("")
dev.off()
```



